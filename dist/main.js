!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=1)}([function(t){t.exports=JSON.parse('[{"title":"Derelict","artist":"Trevino","url":"https://dj-gh.s3.amazonaws.com/01+Derelict.mp3"},{"title":"Departures","artist":"Closer Musik","url":"https://dj-gh.s3.amazonaws.com/02+Departures.mp3"},{"title":"Ferenc","artist":"Ricardo Villalobos","url":"https://dj-gh.s3.amazonaws.com/04+Ferenc.mp3"},{"title":"10","artist":"snd","url":"https://dj-gh.s3.amazonaws.com/10+10.mp3"},{"title":"King in My Empire","artist":"Rhythm & Sound","url":"https://dj-gh.s3.amazonaws.com/01+King+in+My+Empire.mp3"},{"title":"Reflector Pack (4/4)","artist":"Miss Modular","url":"https://dj-gh.s3.amazonaws.com/02+Reflector+Pack+(4_4).mp3"},{"title":"Bullied by Love","artist":"JK Flesh","url":"https://dj-gh.s3.amazonaws.com/1-03+Bullied+by+Love.mp3"},{"title":"In my dreams we\'re almost touching","artist":"Ricky Eat Acid","url":"https://dj-gh.s3.amazonaws.com/08+In+my+dreams+we\'re+almost+touching.mp3"},{"title":"Fall from a Height (The Field remix)","artist":"The Honeydrips","url":"https://dj-gh.s3.amazonaws.com/03+Fall+From+A+Height+-+The+Field+Way.mp3"}]')},function(t,e,n){"use strict";n.r(e);var r=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title=e,this.artist=n,this.url=r};function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(e,n,r){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tracks=n,this.ac=e,this.rotateVar="--track-".concat(r,"-speed"),this.rotateClass="rotate".concat(r),this.tonearmVar="--tonearm-".concat(r),this.paused=!0,this.speed=1,this.currentTime=0,this.ppButton=document.getElementById("ppButton".concat(r)),this.recordImg=document.getElementById("record-img".concat(r)),this.titleText=document.getElementById("track-title".concat(r)),this.artistText=document.getElementById("track-artist".concat(r)),this.trackArea=document.getElementById("track-area".concat(r)),this.panNode=e.createStereoPanner(),this.gainNode=e.createGain(),this.gainNode.gain.value=1===r?1:0,this.restToneArm(),document.getElementById("speed".concat(r)).addEventListener("input",(function(t){a.changeSpeed(t.currentTarget.value)})),document.getElementById("pan".concat(r)).addEventListener("input",(function(t){a.panNode.pan.value=t.currentTarget.value})),this.ppButton.addEventListener("click",(function(){a.playOrPause()})),this.trackArea.addEventListener("dragover",(function(t){t.preventDefault()})),this.trackArea.addEventListener("drop",(function(t){t.preventDefault();var e=a.tracks[t.dataTransfer.getData("text")];a.paused?a.changeTrack(e):(document.querySelector("#error-modal").style.display="block",document.querySelector("#modal-background").style.display="block")}))}var e,n,r;return e=t,(n=[{key:"restToneArm",value:function(){document.documentElement.style.setProperty(this.tonearmVar,"0deg")}},{key:"changeTonearmPosition",value:function(){this.paused||(this.currentTime+=.1*this.speed),document.documentElement.style.setProperty(this.tonearmVar,"".concat(30*this.currentTime/this.buffer.duration+8,"deg")),this.currentTime>=this.buffer.duration&&(this.playOrPause(),this.currentTime=0,clearInterval(this.tonearmInterval),this.restToneArm())}},{key:"changeTrack",value:function(t){var e=this;this.ppButton.setAttribute("disabled",!0),this.titleText.innerHTML="Loading",this.artistText.innerHTML="";var n=new Request(t.url);fetch(n).then((function(t){return t.arrayBuffer()})).then((function(t){return e.ac.decodeAudioData(t)})).then((function(n){e.buffer=n,e.reloadBuffer(),e.ppButton.removeAttribute("disabled"),e.titleText.innerHTML=t.title,e.artistText.innerHTML=t.artist,e.currentTime=0,clearInterval(e.tonearmInterval),e.restToneArm()}))}},{key:"reloadBuffer",value:function(){this.track=this.ac.createBufferSource(),this.track.buffer=this.buffer,this.track.connect(this.gainNode).connect(this.panNode).connect(this.ac.destination),this.changeSpeed(this.speed)}},{key:"changeSpeed",value:function(t){this.speed=t,this.track&&(this.track.playbackRate.value=t),document.documentElement.style.setProperty(this.rotateVar,"".concat(1/t,"s"))}},{key:"playOrPause",value:function(){this.paused?(this.paused=!1,0===this.currentTime&&(this.tonearmInterval=setInterval(this.changeTonearmPosition.bind(this),100)),this.recordImg.classList.add(this.rotateClass),this.track.start(this.ac.currentTime,this.currentTime)):(this.paused=!0,this.recordImg.classList.remove(this.rotateClass),this.track.stop(),this.reloadBuffer())}}])&&a(e.prototype,n),r&&a(e,r),t}(),o=n(0);document.addEventListener("DOMContentLoaded",(function(){var t=new(window.AudioContext||window.webkitAudioContext),e=o.map((function(t){var e=t.title,n=t.artist,a=t.url;return new r(e,n,a)})),n=new i(t,e,1),a=new i(t,e,2),s=document.getElementById("track-bank"),c=document.createElement("ul");e.forEach((function(t,e){var n=document.createElement("li");n.classList.add("track-listing"),n.setAttribute("draggable","true"),n.setAttribute("id",e);var r=document.createElement("div");r.classList.add("label"),r.innerText=t.title,n.appendChild(r),c.appendChild(n)})),s.appendChild(c),document.querySelectorAll(".track-listing").forEach((function(t){var e=new Image;e.src="./src/images/record_sleeve.png",t.addEventListener("dragstart",(function(n){n.dataTransfer.setData("text/plain",t.id),n.dataTransfer.setDragImage(e,150,150)}))})),document.querySelectorAll("button").forEach((function(e){e.addEventListener("click",(function(){"suspended"===t.state&&t.resume()}))})),document.getElementById("crossfader").addEventListener("input",(function(t){var e=t.currentTarget.value;n.gainNode.gain.value=1-e,a.gainNode.gain.value=e})),document.querySelector("#about-modal-button").addEventListener("click",(function(){document.querySelector("#about-modal").style.display="block",document.querySelector("#modal-background").style.display="block"})),document.querySelector("#instructions-modal-button").addEventListener("click",(function(){document.querySelector("#instructions-modal").style.display="block",document.querySelector("#modal-background").style.display="block"})),window.onclick=function(t){var e=t.target;e===document.getElementById("modal-background")&&(e.style.display="none",e.querySelectorAll(".modal").forEach((function(t){t.style.display="none"})))}}))}]);
//# sourceMappingURL=main.js.map